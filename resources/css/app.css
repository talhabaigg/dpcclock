@import 'tailwindcss';

@plugin 'tailwindcss-animate';

@source '../views';
@source '../../vendor/laravel/framework/src/Illuminate/Pagination/resources/views/*.blade.php';

@custom-variant dark (&:is(.dark *));

@theme {
    --font-sans:
        'Instrument Sans', ui-sans-serif, system-ui, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';

    --radius-lg: var(--radius);
    --radius-md: calc(var(--radius) - 2px);
    --radius-sm: calc(var(--radius) - 4px);

    --color-background: var(--background);
    --color-foreground: var(--foreground);

    --color-card: var(--card);
    --color-card-foreground: var(--card-foreground);

    --color-popover: var(--popover);
    --color-popover-foreground: var(--popover-foreground);

    --color-primary: var(--primary);
    --color-primary-foreground: var(--primary-foreground);

    --color-secondary: var(--secondary);
    --color-secondary-foreground: var(--secondary-foreground);

    --color-muted: var(--muted);
    --color-muted-foreground: var(--muted-foreground);

    --color-accent: var(--accent);
    --color-accent-foreground: var(--accent-foreground);

    --color-destructive: var(--destructive);
    --color-destructive-foreground: var(--destructive-foreground);

    --color-border: var(--border);
    --color-input: var(--input);
    --color-ring: var(--ring);

    --color-chart-1: var(--chart-1);
    --color-chart-2: var(--chart-2);
    --color-chart-3: var(--chart-3);
    --color-chart-4: var(--chart-4);
    --color-chart-5: var(--chart-5);

    --color-sidebar: var(--sidebar);
    --color-sidebar-foreground: var(--sidebar-foreground);
    --color-sidebar-primary: var(--sidebar-primary);
    --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
    --color-sidebar-accent: var(--sidebar-accent);
    --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
    --color-sidebar-border: var(--sidebar-border);
    --color-sidebar-ring: var(--sidebar-ring);

}

/*
  The default border color has changed to `currentColor` in Tailwind CSS v4,
  so we've added these compatibility styles to make sure everything still
  looks the same as it did with Tailwind CSS v3.

  If we ever want to remove these styles, we need to add an explicit border
  color utility to any element that depends on these defaults.
*/
@layer base {
    *,
    ::after,
    ::before,
    ::backdrop,
    ::file-selector-button {
        border-color: var(--color-gray-200, currentColor);
    }
}

:root {
    --background: oklch(1 0 0);
    --foreground: oklch(0.145 0 0);
    --card: oklch(1 0 0);
    --card-foreground: oklch(0.145 0 0);
    --popover: oklch(1 0 0);
    --popover-foreground: oklch(0.145 0 0);
    --primary: oklch(0.205 0 0);
    --primary-foreground: oklch(0.985 0 0);
    --secondary: oklch(0.97 0 0);
    --secondary-foreground: oklch(0.205 0 0);
    --muted: oklch(0.97 0 0);
    --muted-foreground: oklch(0.556 0 0);
    --accent: oklch(0.97 0 0);
    --accent-foreground: oklch(0.205 0 0);
    --destructive: oklch(0.577 0.245 27.325);
    --destructive-foreground: oklch(0.577 0.245 27.325);
    --border: oklch(0.922 0 0);
    --input: oklch(0.922 0 0);
    --ring: oklch(0.87 0 0);
    --chart-1: oklch(0.646 0.222 41.116);
    --chart-2: oklch(0.6 0.118 184.704);
    --chart-3: oklch(0.398 0.07 227.392);
    --chart-4: oklch(0.828 0.189 84.429);
    --chart-5: oklch(0.769 0.188 70.08);
    --radius: 0.625rem;
    --sidebar: oklch(0.985 0 0);
    --sidebar-foreground: oklch(0.145 0 0);
    --sidebar-primary: oklch(0.205 0 0);
    --sidebar-primary-foreground: oklch(0.985 0 0);
    --sidebar-accent: oklch(0.97 0 0);
    --sidebar-accent-foreground: oklch(0.205 0 0);
    --sidebar-border: oklch(0.922 0 0);
    --sidebar-ring: oklch(0.87 0 0);
}

.dark {
    --background: oklch(0.145 0 0);
    --foreground: oklch(0.985 0 0);
    --card: oklch(0.145 0 0);
    --card-foreground: oklch(0.985 0 0);
    --popover: oklch(0.145 0 0);
    --popover-foreground: oklch(0.985 0 0);
    --primary: oklch(0.985 0 0);
    --primary-foreground: oklch(0.205 0 0);
    --secondary: oklch(0.269 0 0);
    --secondary-foreground: oklch(0.985 0 0);
    --muted: oklch(0.269 0 0);
    --muted-foreground: oklch(0.708 0 0);
    --accent: oklch(0.269 0 0);
    --accent-foreground: oklch(0.985 0 0);
    --destructive: oklch(0.396 0.141 25.723);
    --destructive-foreground: oklch(0.637 0.237 25.331);
    --border: oklch(0.269 0 0);
    --input: oklch(0.269 0 0);
    --ring: oklch(0.439 0 0);
    --chart-1: oklch(0.488 0.243 264.376);
    --chart-2: oklch(0.696 0.17 162.48);
    --chart-3: oklch(0.769 0.188 70.08);
    --chart-4: oklch(0.627 0.265 303.9);
    --chart-5: oklch(0.645 0.246 16.439);
    --sidebar: oklch(0.205 0 0);
    --sidebar-foreground: oklch(0.985 0 0);
    --sidebar-primary: oklch(0.985 0 0);
    --sidebar-primary-foreground: oklch(0.985 0 0);
    --sidebar-accent: oklch(0.269 0 0);
    --sidebar-accent-foreground: oklch(0.985 0 0);
    --sidebar-border: oklch(0.269 0 0);
    --sidebar-ring: oklch(0.439 0 0);
}

@layer base {
    * {
        @apply border-border;
    }

    body {
        @apply bg-background text-foreground;
    }
}

/* AG Grid Wrapper Styling (legacy - excluded from shadcn theme) */
:not(.ag-theme-shadcn) > .ag-root-wrapper {
    box-shadow:
        0 4px 6px -1px rgba(0, 0, 0, 0.1),
        0 2px 4px -2px rgba(0, 0, 0, 0.1);
    border: 1px solid #e2e8f0;
    border-radius: 12px;
    overflow: hidden;
}

.dark :not(.ag-theme-shadcn) > .ag-root-wrapper {
    box-shadow:
        0 4px 6px -1px rgba(0, 0, 0, 0.4),
        0 2px 4px -2px rgba(0, 0, 0, 0.3);
    border: 1px solid #374151;
    background-color: #111827;
}

/* AG Grid Header Styling (legacy - excluded from shadcn theme) */
:not(.ag-theme-shadcn) .ag-header {
    border-bottom: 2px solid #cbd5e1 !important;
    background-color: #f1f5f9 !important;
}

.dark :not(.ag-theme-shadcn) .ag-header {
    border-bottom: 2px solid #4b5563 !important;
    background-color: #1f2937 !important;
}

.dark :not(.ag-theme-shadcn) .ag-header-cell {
    color: #e5e7eb !important;
}

.dark :not(.ag-theme-shadcn) .ag-header-group-cell {
    color: #e5e7eb !important;
}

/* AG Grid Body Styling (legacy - excluded from shadcn theme) */
.dark :not(.ag-theme-shadcn) .ag-body {
    background-color: #111827 !important;
}

.dark :not(.ag-theme-shadcn) .ag-row {
    background-color: #111827 !important;
}

.dark :not(.ag-theme-shadcn) .ag-row-odd {
    background-color: #0d1117 !important;
}

.dark :not(.ag-theme-shadcn) .ag-cell {
    color: #e5e7eb !important;
    border-color: #374151 !important;
}

/* AG Grid Total Row Styling */
.ag-row-total {
    background-color: #e2e8f0 !important;
    font-weight: 700 !important;
    border-top: 2px solid #94a3b8 !important;
}

.ag-row-total .ag-cell {
    background-color: #e2e8f0 !important;
    color: #1e293b !important;
}

.dark .ag-row-total {
    background-color: #1f2937 !important;
    border-top: 2px solid #4b5563 !important;
}

.dark .ag-row-total .ag-cell {
    background-color: #1f2937 !important;
    color: #f3f4f6 !important;
}

/* AG Grid Row Hover Effect (legacy - excluded from shadcn theme) */
:not(.ag-theme-shadcn) .ag-row:hover:not(.ag-row-total) {
    background-color: #f1f5f9 !important;
}

.dark :not(.ag-theme-shadcn) .ag-row:hover:not(.ag-row-total) {
    background-color: #1e293b !important;
}

/* AG Grid Pinned Columns (legacy - excluded from shadcn theme) */
.dark :not(.ag-theme-shadcn) .ag-pinned-left-cols-container .ag-cell,
.dark :not(.ag-theme-shadcn) .ag-pinned-right-cols-container .ag-cell {
    background-color: #111827 !important;
}

.dark :not(.ag-theme-shadcn) .ag-pinned-left-cols-container .ag-row-odd .ag-cell,
.dark :not(.ag-theme-shadcn) .ag-pinned-right-cols-container .ag-row-odd .ag-cell {
    background-color: #0d1117 !important;
}

.dark :not(.ag-theme-shadcn) .ag-pinned-left-header,
.dark :not(.ag-theme-shadcn) .ag-pinned-right-header {
    background-color: #1f2937 !important;
}

/* ================================
   Unified Forecast Grid Styling
   ================================ */

/* Row type left border indicators */
.forecast-row-revenue {
}

.forecast-row-cost {
    background-color: rgba(251, 191, 36, 0.05) !important;
}

.dark .forecast-row-cost {
    background-color: rgba(251, 191, 36, 0.08) !important;
}

.forecast-row-profit {
    background-color: rgba(59, 130, 246, 0.05) !important;
}

.dark .forecast-row-profit {
    background-color: rgba(59, 130, 246, 0.08) !important;
}

.forecast-row-target {
    background-color: rgba(139, 92, 246, 0.05) !important;
}

.dark .forecast-row-target {
    background-color: rgba(139, 92, 246, 0.08) !important;
}

.forecast-row-variance {
}

.forecast-row-labour {
    background-color: rgba(168, 85, 247, 0.08) !important;
}

.dark .forecast-row-labour {
    background-color: rgba(168, 85, 247, 0.15) !important;
}

.forecast-row-total {
    background-color: #f1f5f9 !important;
    font-weight: 700 !important;
}

.dark .forecast-row-total {
    background-color: #1e293b !important;
}

/* Header styling for actual vs forecast months */
.forecast-header-actual {
    background-color: rgba(16, 185, 129, 0.1) !important; /* emerald */
    border-bottom: 2px solid #10b981 !important;
}

.dark .forecast-header-actual {
    background-color: rgba(16, 185, 129, 0.15) !important;
}

.forecast-header-forecast {
    background-color: rgba(59, 130, 246, 0.08) !important; /* blue */
    border-bottom: 2px solid #93c5fd !important;
}

.dark .forecast-header-forecast {
    background-color: rgba(59, 130, 246, 0.12) !important;
    border-bottom-color: #3b82f6 !important;
}

/* View mode toggle styling */
.forecast-view-toggle {
    @apply flex gap-1 rounded-lg border border-slate-200 bg-slate-50/50 p-1;
}

.dark .forecast-view-toggle {
    @apply border-slate-700 bg-slate-800/50;
}

/* Pinned bottom row styling for totals (legacy - excluded from shadcn theme) */
:not(.ag-theme-shadcn) .ag-row-pinned {
    font-weight: 600 !important;
    background-color: #f8fafc !important;
    border-top: 2px solid #cbd5e1 !important;
}

:not(.ag-theme-shadcn) .ag-row-pinned .ag-cell {
    background-color: #f8fafc !important;
}

.dark :not(.ag-theme-shadcn) .ag-row-pinned {
    background-color: #1e293b !important;
    border-top-color: #475569 !important;
}

.dark :not(.ag-theme-shadcn) .ag-row-pinned .ag-cell {
    background-color: #1e293b !important;
    color: #f1f5f9 !important;
}

/* Smooth transitions for row hover */
.ag-row {
    transition: background-color 0.15s ease;
}

/* Better focus states (legacy - excluded from shadcn theme) */
:not(.ag-theme-shadcn) .ag-cell-focus {
    outline: 2px solid #3b82f6 !important;
    outline-offset: -2px;
}

.dark :not(.ag-theme-shadcn) .ag-cell-focus {
    outline-color: #60a5fa !important;
}

/* ================================
   Shadcn-style AG Grid Theme
   Clean, minimal styling matching shadcn/ui table
   ================================ */
.ag-theme-shadcn {
    border-radius: 8px !important;
    overflow: hidden !important;
    border: 1px solid #e4e4e7 !important;
}

.dark .ag-theme-shadcn {
    border-color: #27272a !important;
}

.ag-theme-shadcn .ag-root-wrapper {
    border: none !important;
    border-radius: 0 !important;
    box-shadow: none !important;
    overflow: hidden;
}

.dark .ag-theme-shadcn .ag-root-wrapper {
    background-color: #09090b !important;
}

.ag-theme-shadcn .ag-header {
    background-color: transparent !important;
    border-bottom: 1px solid #e4e4e7 !important;
}

.dark .ag-theme-shadcn .ag-header {
    background-color: transparent !important;
    border-bottom-color: #27272a !important;
}

.ag-theme-shadcn .ag-header-cell {
    font-weight: 500 !important;
    font-size: 12px !important;
    color: #71717a !important;
}

.dark .ag-theme-shadcn .ag-header-cell {
    color: #a1a1aa !important;
}

.ag-theme-shadcn .ag-row {
    border-bottom: 1px solid #e4e4e7 !important;
    background-color: transparent !important;
}

.dark .ag-theme-shadcn .ag-row {
    border-bottom-color: #27272a !important;
}

.ag-theme-shadcn .ag-row:last-child {
    border-bottom: none !important;
}

.ag-theme-shadcn .ag-row:hover {
    background-color: #f4f4f5 !important;
}

.dark .ag-theme-shadcn .ag-row:hover {
    background-color: #18181b !important;
}

.ag-theme-shadcn .ag-row-selected {
    background-color: #f4f4f5 !important;
}

.dark .ag-theme-shadcn .ag-row-selected {
    background-color: #27272a !important;
}

.ag-theme-shadcn .ag-cell {
    font-size: 14px !important;
    color: #18181b !important;
    border: none !important;
}

.dark .ag-theme-shadcn .ag-cell {
    color: #fafafa !important;
}

.ag-theme-shadcn .ag-body {
    background-color: transparent !important;
}

.dark .ag-theme-shadcn .ag-body {
    background-color: #09090b !important;
}

/* Pinned left columns - border separator */
.ag-theme-shadcn .ag-pinned-left-header {
    border-right: 2px solid #d4d4d8 !important;
}

.dark .ag-theme-shadcn .ag-pinned-left-header {
    border-right: 2px solid #3f3f46 !important;
}

.ag-theme-shadcn .ag-pinned-left-cols-container {
    border-right: 2px solid #d4d4d8 !important;
}

.dark .ag-theme-shadcn .ag-pinned-left-cols-container {
    border-right: 2px solid #3f3f46 !important;
}

/* AG Grid Cell Error Styling */
.ag-cell-error {
    background-color: rgba(239, 68, 68, 0.08) !important;
    border-left: 3px solid #ef4444 !important;
}

/* Importer wizard row highlighting */
.importer-row-error {
    background-color: rgba(239, 68, 68, 0.08) !important;
}

.dark .importer-row-error {
    background-color: rgba(239, 68, 68, 0.12) !important;
}

.importer-row-warning {
    background-color: rgba(245, 158, 11, 0.06) !important;
}

.dark .importer-row-warning {
    background-color: rgba(245, 158, 11, 0.1) !important;
}

.dark .ag-cell-error {
    background-color: rgba(239, 68, 68, 0.15) !important;
    border-left-color: #f87171 !important;
}

/* ================================
   Agent Live View Animations
   ================================ */
@keyframes scanline {
    0% { transform: translateY(-100%); opacity: 0; }
    10% { opacity: 0.6; }
    90% { opacity: 0.6; }
    100% { transform: translateY(3000%); opacity: 0; }
}

.agent-scanline {
    animation: scanline 3s ease-in-out infinite;
}

@keyframes agent-glow {
    0% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
    50% { box-shadow: 0 0 20px 4px rgba(16, 185, 129, 0.3); }
    100% { box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
}

.agent-completed-glow {
    animation: agent-glow 2s ease-out forwards;
}

/* ================================
   FullCalendar — Shadcn Theme
   ================================ */

/* Root wrapper */
.fc {
    --fc-border-color: var(--border);
    --fc-today-bg-color: transparent;
    --fc-neutral-bg-color: transparent;
    --fc-page-bg-color: transparent;
    --fc-event-border-color: transparent;
    --fc-event-bg-color: transparent;
    --fc-event-text-color: inherit;
    font-family: var(--font-sans);
}

/* Toolbar (header with title + navigation) */
.fc .fc-toolbar {
    gap: 0.75rem;
    margin-bottom: 0 !important;
    padding: 1rem 1rem 0.75rem;
}

.fc .fc-toolbar-title {
    font-size: 1.125rem !important;
    font-weight: 600 !important;
    color: var(--foreground);
}

/* Navigation buttons */
.fc .fc-button {
    background-color: transparent !important;
    border: 1px solid var(--border) !important;
    color: var(--foreground) !important;
    border-radius: var(--radius) !important;
    font-size: 0.875rem !important;
    font-weight: 500 !important;
    padding: 0.375rem 0.75rem !important;
    box-shadow: none !important;
    transition: background-color 0.15s ease, color 0.15s ease;
}

.fc .fc-button:hover {
    background-color: var(--accent) !important;
    color: var(--accent-foreground) !important;
}

.fc .fc-button:focus {
    box-shadow: 0 0 0 2px var(--ring) !important;
    outline: none !important;
}

.fc .fc-button-active,
.fc .fc-button:active {
    background-color: var(--primary) !important;
    color: var(--primary-foreground) !important;
    border-color: var(--primary) !important;
}

.fc .fc-button-primary:disabled {
    opacity: 0.5 !important;
}

/* Prev/Next icon buttons */
.fc .fc-prev-button,
.fc .fc-next-button {
    padding: 0.375rem !important;
}

/* Day grid header (Mon, Tue, etc.) */
.fc .fc-col-header-cell {
    background-color: transparent;
    border-color: var(--border);
    padding: 0.5rem 0;
}

.fc .fc-col-header-cell-cushion {
    font-size: 0.75rem !important;
    font-weight: 500 !important;
    color: var(--muted-foreground);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    text-decoration: none !important;
}

/* Day cells */
.fc .fc-daygrid-day {
    border-color: var(--border);
    transition: background-color 0.15s ease;
}

.fc .fc-daygrid-day:hover {
    background-color: var(--accent);
    cursor: pointer;
}

.fc .fc-daygrid-day-number {
    font-size: 0.8rem;
    font-weight: 400;
    color: var(--muted-foreground);
    padding: 0.375rem 0.5rem;
    text-decoration: none !important;
}

/* Today cell */
.fc .fc-day-today {
    background-color: transparent !important;
}

.fc .fc-day-today .fc-daygrid-day-number {
    background-color: var(--primary);
    color: var(--primary-foreground);
    border-radius: 9999px;
    width: 1.75rem;
    height: 1.75rem;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
}

/* Other month days */
.fc .fc-day-other .fc-daygrid-day-number {
    color: var(--muted-foreground);
    opacity: 0.4;
}

/* Table borders — Card handles outer rounding + clipping */
.fc .fc-scrollgrid {
    border: none !important;
    border-radius: 0 !important;
}

.fc .fc-scrollgrid td,
.fc .fc-scrollgrid th {
    border-color: var(--border) !important;
}

/* Events container */
.fc .fc-daygrid-day-events {
    padding: 0 0.25rem 0.25rem;
}

/* Event element */
.fc .fc-daygrid-event {
    border-radius: calc(var(--radius) - 2px) !important;
    border: none !important;
    margin-top: 2px !important;
}

.fc .fc-event {
    border: none !important;
    background: none !important;
}

/* "More" link */
.fc .fc-daygrid-more-link {
    font-size: 0.75rem;
    font-weight: 500;
    color: var(--primary);
    padding: 0.125rem 0.25rem;
    border-radius: calc(var(--radius) - 4px);
}

.fc .fc-daygrid-more-link:hover {
    background-color: var(--accent);
}

/* Popover for "+N more" */
.fc .fc-popover {
    border: 1px solid var(--border) !important;
    border-radius: var(--radius) !important;
    background: var(--popover) !important;
    box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1) !important;
}

.fc .fc-popover-header {
    background: var(--muted) !important;
    padding: 0.5rem 0.75rem !important;
    font-size: 0.8rem !important;
    font-weight: 500 !important;
    color: var(--muted-foreground);
}

/* Remove the outer table border-bottom for cleanliness */
.fc .fc-scrollgrid-section > * {
    border-color: var(--border) !important;
}
